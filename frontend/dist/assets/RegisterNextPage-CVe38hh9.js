import{r as t,F as I,u as P,b as L,j as e,N as M,L as O,a as i,B as c}from"./index-DoGYxv9T.js";import{l as $}from"./ees-logo-Bkb-RtId.js";const l="http://13.234.46.69:3000",F="rzp_test_15Itqkn7OjvmAs";console.log(F,"keyy");const W=()=>{const{fcmToken:f}=t.useContext(I),[n,h]=t.useState([]),[d,m]=t.useState(!1),[g,b]=t.useState(""),[u,j]=t.useState(""),[v,w]=t.useState([]),[T,N]=t.useState(""),[q,p]=t.useState(!1),k=localStorage.getItem("token"),C=P(),R=L().state||{};if(k)return e.jsx(M,{to:"/"});const S=()=>{m(!d)},A=s=>{h(s),m(!1)},_=async()=>{try{const r=(await i.get(`${l}/category/getAllCategory`)).data.category.sort((o,a)=>o.categoryName.localeCompare(a.categoryName));w(r)}catch(s){console.error("Error fetching categories:",s)}};t.useEffect(()=>{_()},[]);const z=async s=>{s.preventDefault(),p(!0);const r={...R,businessName:g,businessCategory:n,businessAddress:u,fcmToken:f};try{const a=(await i.post(`${l}/payment/create-order`,{amount:121,currency:"INR"})).data,E={key:"rzp_test_15Itqkn7OjvmAs",amount:a.amount,currency:a.currency,name:"Business Registration",description:"Payment for Registration",order_id:a.id,handler:async B=>{const D=B.razorpay_payment_id;try{if((await i.post(`${l}/payment/verify-payment`,{payment_id:D},{headers:{"Content-Type":"application/json"}})).data.success){const y=await i.post(`${l}/auth/registerUserweb`,r,{headers:{"Content-Type":"application/json"}});y.status===200?(c("Registration Successful!"),C("/login")):N(y.data.message||"Registration failed.")}else c.error("Payment verification failed.")}catch(x){console.error("Error verifying payment or registering user:",x),c.error("An error occurred during registration. Please try again.")}},prefill:{name:r.name,email:r.email,contact:r.phone},theme:{color:"#3399cc"}};new window.Razorpay(E).open()}catch(o){console.error("Error during payment process:",o),c.error("Failed to initiate payment. Please try again.")}finally{p(!1)}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"  text-gray-900 w-full flex justify-center",children:e.jsxs("div",{className:" sm:m-10 bg-white w-full shadow sm:rounded-lg flex justify-center flex-1",children:[e.jsx("div",{className:"lg:w-1/2 xl:w-6/12 p-6 sm:p-12",children:e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"w-full flex-1 mt-8",children:[e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("div",{className:"mb-12",children:e.jsx("img",{src:$,width:100})})}),e.jsx("div",{className:"my-3 border-b text-center",children:e.jsx("div",{className:"leading-none px-2 inline-block text-sm text-gray-600 tracking-wide font-medium bg-white transform translate-y-1/2"})}),e.jsx("form",{action:"",onSubmit:z,children:e.jsxs("div",{className:"mx-auto max-w-full",children:[e.jsx("input",{value:g,onChange:s=>b(s.target.value),className:"w-full px-8 py-4 rounded-lg font-medium bg-gray-100 border border-gray-200 placeholder-gray-500 text-sm focus:outline-none focus:border-gray-400 focus:bg-white mt-3",type:"text",placeholder:"Bussiness Name"}),e.jsxs("div",{className:"mt-3 w-full",children:[e.jsx("div",{className:" border border-1 rounded-md p-3 w-full  bg-gray-100 focus:bg-white cursor-pointer",onClick:S,children:n.length>0?e.jsx("span",{className:"inline-block text-capitalize px-3 text-black py-1  ",children:n}):e.jsx("span",{className:"text-gray-500 ps-3 py-1",children:"Select a category"})}),d&&e.jsx("ul",{className:"z-10 border border-gray-300 bg-white w-full mt-2 rounded-md  max-h-40 overflow-y-auto",children:v.map((s,r)=>e.jsx("li",{className:`cursor-pointer text-capitalize px-4 py-2 hover:bg-green-200 ${n===s.categoryName?"bg-green-200":""}`,onClick:()=>A(s.categoryName),children:s.categoryName},r))})]}),e.jsx("input",{value:u,onChange:s=>j(s.target.value),className:"w-full px-8 py-4 rounded-lg font-medium bg-gray-100 border border-gray-200 placeholder-gray-500 text-sm focus:outline-none focus:border-gray-400 focus:bg-white mt-3",type:"text",placeholder:"Bussiness Address"}),e.jsxs("button",{type:"submit",className:"mt-3 tracking-wide font-semibold bg-green-600 text-white w-full py-4 rounded-lg hover:bg-green-700 transition-all duration-300 ease-in-out flex items-center justify-center focus:shadow-outline focus:outline-none",children:[e.jsxs("svg",{className:"w-6 h-6 -ml-2",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"}),e.jsx("circle",{cx:"8.5",cy:7,r:4}),e.jsx("path",{d:"M20 8v6M23 11h-6"})]}),e.jsx("span",{className:"ml-4",children:"Sign Up"})]}),e.jsxs("p",{className:"mt-4 text-sm text-center text-gray-600",children:["Allready have an account? ",e.jsx(O,{to:"/login",className:"text-success text-bold hover:underline",children:"login "})]})]})})]})})}),e.jsx("div",{className:"flex-1 bg-green-100 text-center hidden lg:flex",children:e.jsx("div",{className:"m-12 xl:m-16 w-full bg-contain bg-center bg-no-repeat",children:e.jsx("img",{src:"https://readymadeui.com/signin-image.webp",alt:""})})})]})})})})})};export{W as default};
