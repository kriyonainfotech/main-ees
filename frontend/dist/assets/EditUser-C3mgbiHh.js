import{r as s,b as M,u as Q,j as e,a as $}from"./index-g8GziE3t.js";import{A as V}from"./AdminNavbar-BqDe4lKh.js";import"./ess-121-DfLSNCpt.js";import"./index-CTpsVrPL.js";const F="http://localhost:3000",te=()=>{const[I,L]=s.useState([]),[b,g]=s.useState(""),[h,y]=s.useState(""),[f,j]=s.useState(""),[N,v]=s.useState(""),[w,d]=s.useState(""),[C,c]=s.useState(""),[k,i]=s.useState(""),[S,u]=s.useState(""),[W,n]=s.useState("");s.useState("");const[m,A]=s.useState([]),[O,T]=s.useState(""),[E,P]=s.useState(""),[q,D]=s.useState(!1),[p,U]=s.useState(!1),a=M(),_=Q(),z=async()=>{try{const r=(await $.get(`${F}/category/getAllCategory`)).data.category.sort((l,o)=>l.categoryName.localeCompare(o.categoryName));L(r)}catch(t){console.error("Error fetching categories:",t)}};s.useEffect(()=>{var t,r,l,o,B;z(),a!=null&&a.state&&(g(a.state.name||""),y(a.state.email||""),j(a.state.phone||""),d(((t=a.state.address)==null?void 0:t.area)||""),c(((r=a.state.address)==null?void 0:r.city)||""),i(((l=a.state.address)==null?void 0:l.state)||""),u(((o=a.state.address)==null?void 0:o.country)||""),v(((B=a.state.address)==null?void 0:B.pincode)||""),A(a.state.businessCategory||[]),T(a.state.businessName||""),P(a.state.businessAddress||""))},[a]);const R=()=>D(!q),G=t=>{A(t),D(!1)},H=async t=>{try{const l=await(await fetch(`https://api.postalpincode.in/pincode/${t}`)).json();if(l[0].Status==="Success"){const o=l[0].PostOffice[0];d(o.Name||""),c(o.District||""),i(o.State||""),u(o.Country||""),n("")}else n("Invalid Pincode! Please enter a valid one."),x()}catch{n("Failed to fetch location details. Try again later."),x()}},x=()=>{d(""),c(""),i(""),u("")},J=t=>{const r=t.target.value.trim();v(r),r.length===6?H(r):(x(),n(""))},K=async t=>{t.preventDefault();const r={area:w,city:C,state:k,country:S,pincode:N},l={userId:a.state._id,name:b,email:h,phone:f,address:r,businessCategory:m,businessName:O,businessAddress:E};U(!0);try{(await $.put(`${F}/auth/UpdateUser`,l,{headers:{"Content-Type":"application/json"},withCredentials:!0})).status===200&&_("/admin")}catch(o){console.error(o),n("Failed to update user. Please try again.")}finally{U(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(V,{}),e.jsx("div",{className:"bg-gray-200 pt-15 flex items-center mt-24 justify-center",children:e.jsx("div",{className:"w-[600px] bg-white rounded-lg overflow-hidden shadow-md mt-5 mx-2",children:e.jsxs("div",{className:"py-3 px-6 grid grid-cols-1 gap-6",children:[e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("h3",{className:"text-3xl font-semibold text-red-500 pt-3",children:"Edit User"})}),e.jsxs("form",{onSubmit:K,method:"post",className:"space-y-4 dark:text-white",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Name"}),e.jsx("input",{type:"text",value:b,onChange:t=>g(t.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Email"}),e.jsx("input",{type:"email",value:h,onChange:t=>y(t.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Contact"}),e.jsx("input",{type:"text",value:f,onChange:t=>j(t.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Area"}),e.jsx("input",{type:"text",value:w,onChange:t=>d(t.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Pincode"}),e.jsx("input",{type:"text",value:N,onChange:J,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"City"}),e.jsx("input",{type:"text",value:C,onChange:t=>c(t.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"State"}),e.jsx("input",{type:"text",value:k,onChange:t=>i(t.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Country"}),e.jsx("input",{type:"text",value:S,onChange:t=>u(t.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{className:"w-full mt-10",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Select Business Categories:"}),e.jsxs("div",{className:"mt-3 w-full",children:[e.jsx("div",{className:"mt-1 block w-full border border-gray-300 rounded-md p-2",onClick:R,children:m.length>0?e.jsx("span",{className:"inline-block text-black py-1",children:m}):e.jsx("span",{className:"py-1",children:"Select a category"})}),q&&e.jsx("ul",{className:"z-10 border border-gray-300 bg-white w-full mt-2 rounded-md max-h-40 overflow-y-auto",children:I.map((t,r)=>e.jsx("li",{className:`cursor-pointer px-4 py-2 hover:bg-green-200 ${m===t.categoryName?"bg-green-200":""}`,onClick:()=>G(t.categoryName),children:t.categoryName},r))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Business Address"}),e.jsx("input",{type:"text",value:E,onChange:t=>P(t.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsx("button",{type:"submit",className:`w-full py-2 rounded-md ${p?"bg-gray-500":"bg-red-600"} text-white font-bold`,disabled:p,children:p?"Updating...":"Edit User"})]})]})})})]})};export{te as default};
