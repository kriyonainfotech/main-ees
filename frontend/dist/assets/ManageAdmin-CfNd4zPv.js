import{r as c,j as e,a as x,B as f,u as g}from"./index-g8GziE3t.js";import{a as b}from"./index-CTpsVrPL.js";import{F as N}from"./index-DmNBRChd.js";import{A as u,a as v}from"./AdminSidebar-DtemeWQs.js";import"./ess-121-DfLSNCpt.js";const y="http://localhost:3000",U=()=>{const[n,o]=c.useState(""),[h,i]=c.useState("User"),[m,s]=c.useState(null),[t,a]=c.useState(!1),r=async()=>{if(!n){s("Email is required");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)){s("Please enter a valid email address");return}s(null),a(!0);try{(await x.put(`${y}/auth/updateRoleByEmail`,{email:n,role:h})).status===200&&(f.success("User role updated successfully"),o(""),i("User"))}catch(d){d.response?s(d.response.data.message||"Something went wrong"):s("Network error or timeout")}finally{a(!1)}};return e.jsx(e.Fragment,{children:e.jsx("section",{children:e.jsx("div",{className:"container mt-5",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h4",{className:"card-title mb-4",children:"Update User Role"}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"form-label",children:"Email"}),e.jsx("input",{type:"email",id:"email",className:"form-control",placeholder:"Enter Email",value:n,onChange:l=>o(l.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"role",className:"form-label",children:"Select Role"}),e.jsxs("select",{id:"role",className:"form-select",value:h,onChange:l=>i(l.target.value),children:[e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"User",children:"User"})]})]})]}),m&&e.jsx("p",{className:"text-danger",children:m}),e.jsx("button",{className:"btn bg-blue text-white mt-3",onClick:r,disabled:t,children:t?"Updating...":"Update Role"})]})})})})})})})},p="http://localhost:3000",S=()=>{const[n,o]=c.useState([]),h=g(),i=async()=>{try{const s=await x.get(`${p}/auth/getAllUser`,{headers:{"Content-Type":"application/json"}}),a=(await s.data).user.filter(r=>r.role==="Admin");o(a),console.log(a,"AllUser"),s.status===200&&console.log("All User Successful...")}catch(s){s.code==="ECONNABORTED"?console.error("Request timed out"):console.error("Error:",s.message)}};c.useEffect(()=>{i()},[]);const m=async s=>{console.log(s);try{const t=await x.delete(`${p}/auth/deleteUser`,{headers:{"Content-Type":"application/json"},data:{id:s}});console.log(t.data,"delet data"),t.status===200&&(alert("User deleted successfully"),console.log("User deleted successfully"),i())}catch(t){console.log(t)}};return e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsx(v,{}),e.jsx("div",{className:"mt-40",children:e.jsx(U,{})}),e.jsx("section",{className:"",children:e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:" card bg-base-100 shadow-xl mt-5",children:[e.jsx("div",{className:"card-header text-xl text-bold z-30 py-3",children:"Admins"}),e.jsx("div",{className:"overflow-x-auto ",children:e.jsxs("table",{className:"table table-bordered  flex  z-0 border  p-5",children:[e.jsx("thead",{className:"text-bold text-[15px] text-black z-30",children:e.jsxs("tr",{children:[e.jsx("th",{children:"SrNo"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Contect"}),e.jsx("th",{children:"Address"}),e.jsx("th",{children:"businessCategory"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:n.map((s,t)=>{var a,r,l,d,j;return e.jsxs("tr",{children:[e.jsx("th",{children:++t}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.email}),e.jsx("td",{children:s.phone}),e.jsxs("td",{children:[(a=s==null?void 0:s.address)==null?void 0:a.area," ",(r=s==null?void 0:s.address)==null?void 0:r.city," ",(l=s==null?void 0:s.address)==null?void 0:l.state," ",(d=s==null?void 0:s.address)==null?void 0:d.country," ",(j=s==null?void 0:s.address)==null?void 0:j.pincode]}),e.jsx("td",{children:s.businessCategory}),e.jsx("td",{children:s.role}),e.jsxs("td",{className:"d-flex",children:[e.jsx("button",{onClick:()=>m(s._id),className:"btn-xl m-1 fs-3 text-primary",children:e.jsx(b,{})}),e.jsx("button",{onClick:()=>h("/admin/editUser",{state:s}),className:"btn-xl fs-4 text-green-500",children:e.jsx(N,{})})]})]},t)})})]})})]})})})]})};export{S as default};
