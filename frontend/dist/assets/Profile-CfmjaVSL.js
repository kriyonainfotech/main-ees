import{r as d,j as e,a as b,B as j,U as k,u as C}from"./index-DoGYxv9T.js";import{A as P,P as S}from"./AdminNavbar-BPVSybcJ.js";import{F as B,a as E}from"./index-CUuEaMtD.js";import{U as A}from"./UserSideBar-CjrVd-Lf.js";import{P as F}from"./ProfileSidebar-CHlYRdqV.js";import{G as U}from"./GetUserRating-C1REel3v.js";import"./ess-121-BLXCrdn4.js";import"./index-Bp9tcAeh.js";const $="http://13.234.46.69:3000",L=()=>{const[t,r]=d.useState(null),[c,o]=d.useState(null),i=JSON.parse(localStorage.getItem("token")),p=s=>{const a=s.target.files[0];r(a),o(URL.createObjectURL(a))},m=async s=>{if(s.preventDefault(),!t){alert("Please upload an image");return}const a=new FormData;a.append("banner",t),console.log("FormData:",Object.fromEntries(a));try{const l=await b.post(`${$}/banner/addBanner`,a,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${i}`}});console.log(l.data),alert("Banner Added Successfully"),r(null),o(null),l.status}catch(l){console.error("Error details:",l),alert("Failed to upload banner. Check the console for more details.")}};return e.jsx(e.Fragment,{children:e.jsx("form",{action:"",onSubmit:m,children:e.jsxs("div",{className:"",children:[e.jsx("label",{htmlFor:"file-upload",class:"h-[100px] btn d-inline-block border border-orange d-flex justify-content-center align-items-center  text-center ",children:"Add Offer Benner"}),e.jsx("input",{type:"file",id:"file-upload",name:"banner",onChange:p}),c&&e.jsx("img",{src:c,alt:"Preview",width:"200"}),e.jsx("input",{type:"submit",name:"",id:""})]})})})},v="http://13.234.46.69:3000",I=()=>{const[t,r]=d.useState([]),[c,o]=d.useState(null),i=JSON.parse(localStorage.getItem("token"));if(!i)return e.jsx("div",{children:"You must be logged in to view banners."});const p=async()=>{try{const s=await b.get(`${v}/banner/getBanners`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`}});if(s.status===200){const a=s.data;r(a.banners)}}catch(s){o("Error fetching banners. Please try again later."),console.error("Error fetching banners:",s)}},m=async s=>{try{(await b.delete(`${v}/banner/deleteBanner`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},data:{bannerId:s}})).status===200&&(console.log("Banner deleted successfully"),p())}catch(a){o("Error deleting banner. Please try again later."),console.error("Error deleting banner:",a)}};return d.useEffect(()=>{p()},[]),e.jsx("section",{className:"mt-3",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12 d-flex flex-wrap",children:[c&&e.jsx("div",{className:"alert alert-danger",children:c}),t.length>0?t.map((s,a)=>e.jsx("div",{className:"col-md-4 p-1",children:e.jsxs("div",{className:"card card-banners h-100 w-100 overflow-hidden",children:[e.jsx("div",{className:"img-banner",style:{height:"100%"},children:e.jsx("img",{src:s.imageUrl,className:"card-img-top overflow-hidden img-fluid",style:{objectFit:"cover",height:"100%"},alt:s.description||"Banner"})}),e.jsx("div",{className:"banner-Btn",children:e.jsx("button",{className:"btn bg-orange text-white",onClick:()=>m(s._id),children:"Delete"})})]})},a)):e.jsx("div",{children:"No banners available."})]})})})})},_="http://13.234.46.69:3000",R=({user:t})=>{var l,x,g,h,y;const[r,c]=d.useState({}),[o,i]=d.useState(!1),[p,m]=d.useState(!1),s=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(f=>{const{latitude:u,longitude:N}=f.coords,w=`https://nominatim.openstreetmap.org/reverse?format=json&lat=${u}&lon=${N}`;fetch(w).then(n=>n.json()).then(n=>{console.log(n.address,"Fetched Location"),n&&n.address?c({area:n.address.suburb||n.address.county||"",city:n.address.state_district||"",state:n.address.state||"",country:n.address.country||"",pincode:n.address.postcode||""}):j.error("Unable to fetch location details. Please try again.")}).catch(n=>console.error("Error fetching city:",n))},f=>console.error("Error getting location:",f)):j.error("Geolocation is not supported by your browser.")},a=async()=>{if(!r.area&&!r.city&&!r.state&&!r.country&&!r.pincode){j.error("Please fetch your current location first!");return}m(!0);const f=JSON.parse(localStorage.getItem("token"));try{(await b.post(`${_}/auth/updateProfile`,{address:r},{headers:{Authorization:`Bearer ${f}`},withCredentials:!0})).status===200?(i(!1),window.location.reload()):j.error("Failed to update location")}catch(u){console.error("Error updating profile:",u),j.error("Failed to update profile. Please try again.")}finally{m(!1)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex  gap-2",children:[e.jsxs("p",{className:"text-gray pb-3 mb-0",children:[(l=t==null?void 0:t.address)==null?void 0:l.area," ",(x=t==null?void 0:t.address)==null?void 0:x.city," ",(g=t==null?void 0:t.address)==null?void 0:g.state," ",(h=t==null?void 0:t.address)==null?void 0:h.country," ",(y=t==null?void 0:t.address)==null?void 0:y.pincode]}),e.jsx(B,{className:"fs-5 cursor-pointer",onClick:()=>{o?a():s(),i(!o)}})]}),o&&e.jsxs("p",{className:"",children:["Current Location: ",r.area," ",r.city," ",r.state," ",r.country," ",r.pincode,e.jsx("button",{onClick:a,className:"btn border ms-2",children:"Update"})]})]})},H=()=>{var a;const{user:t}=d.useContext(k),[r,c]=d.useState(!1),o=C(),i=`https://ess-frontend-eight.vercel.app/register?referralCode=${t==null?void 0:t.referralCode}`,p=()=>{navigator.clipboard.writeText(i),c(!0),setTimeout(()=>c(!1),2e3)},m=(l,x=10)=>{const g=[];for(let h=1;h<=x;h++)g.push(e.jsx(E,{className:` ${h<=l?"text-warning":"text-muted"}`,style:{cursor:"pointer"}},h));return g},s=(a=t==null?void 0:t.ratings)!=null&&a.length?(t==null?void 0:t.ratings.reduce((l,x)=>l+x.rating,0))/(t==null?void 0:t.ratings.length):0;return e.jsxs(e.Fragment,{children:[e.jsx(P,{}),e.jsx(A,{}),e.jsx(F,{}),e.jsxs("div",{className:"my-24",children:[e.jsx("section",{className:"p-4",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card rounded-md overflow-hidden border-0 bg-base-100 shadow-xl",children:[e.jsxs("div",{className:"w-full position-relative bg-orange flex items-center justify-center",children:[e.jsx("img",{className:"h-[200px] w-full",src:"https://img.freepik.com/free-vector/colorful-watercolor-texture-background_1035-19319.jpg?ga=GA1.1.897959581.1731651336&semt=ais_hybrid",alt:""}),e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"position-absolute w-[150px] h-[150px] top-[120px] start-[50px] overflow-hidden ring-green ring-offset-base-100 w-32 rounded-full ring ring-offset-2",children:e.jsx("img",{src:(t==null?void 0:t.profilePic)||"https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/User_icon_2.svg/220px-User_icon_2.svg.png",alt:"Profile"})})})]}),e.jsx("div",{children:e.jsxs("div",{className:"col-12 d-flex flex-wrap",children:[e.jsxs("div",{className:"col-12 col-md-6 p-5",children:[e.jsxs("div",{className:"rats pt-5",children:[e.jsx("h2",{className:"text-sm text-start font-bold",children:"User Rating"}),e.jsx(U,{}),e.jsxs("div",{className:"rating d-flex  flex-col rating-sm py-2 ",children:[e.jsx("h2",{className:" text-sm font-bold",children:"Provider Rating"}),e.jsxs("div",{className:"d-flex",children:[m(s,10),e.jsxs("span",{className:" ms-2 p-0 ",children:["(",s.toFixed(1),")"]})]})]})]}),e.jsx("h2",{className:"text-3xl font-bold text-gray-700",children:t==null?void 0:t.name}),e.jsx("h6",{className:"py-3 text-gray",children:t==null?void 0:t.email}),e.jsxs("p",{className:"text-gray pb-3",children:[" +91",t==null?void 0:t.phone]}),e.jsx(R,{user:t}),e.jsx("div",{className:"flex",children:e.jsx("button",{onClick:()=>o("/editprofile",{state:t}),className:"text-orange py-3 rounded-full font-semibold uppercase text-sm",children:"Edit Profile"})})]}),e.jsx("div",{className:"col-12 col-md-6 d-flex justify-content-md-end justify-content-start",children:e.jsxs("div",{className:"p-5 w-full",children:[e.jsx("p",{className:"text-gray",children:"Your Referral Link :"}),e.jsx("span",{onClick:p,className:"text-blue-500 cursor-pointer",children:i}),r&&e.jsx("p",{className:"text-green-500",children:"Link copied!"}),e.jsxs("h6",{className:"text-gray py-3",children:["Business Category ",e.jsx(S,{className:"inline-block"})]}),(t==null?void 0:t.businessCategory)&&e.jsx("div",{className:"btn d-flex justify-content-center text-uppercase rounded-md text-white bg-orange py-2",children:t.businessCategory}),e.jsx("div",{className:"pt-4",children:e.jsx(L,{})})]})})]})})]})})})})}),e.jsx(I,{})]})]})};export{H as default};
